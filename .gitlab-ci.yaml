gitleaks_scan:
  stage: security
  image:
    name: zricethezav/gitleaks
    entrypoint: [""]
  script:
    - gitleaks detect --source . --report-format json --report-path gitleaks-report.json --verbose
  artifacts:
    paths:
      - gitleaks-report.json
    when: always  # <-- Always save the report, even if the job fails
  allow_failure: true  # <-- Set to true if you want pipeline to pass regardless of findings (not recommended for security)
