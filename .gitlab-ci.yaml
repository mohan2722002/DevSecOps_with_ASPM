stages:
  - building
  - scans
  
variables:
  DOCKER_TLS_CERTDIR: ""

before_script:
  - docker info

build:
  stage: building
  tags:
    - centos  # Make sure your local GitLab runner is tagged this way
  script:
    - echo "ðŸš§ Building containers using Docker Compose..."
    - docker compose -f .build/docker-compose.yml up -d 


# Simple image vulnerability scanning
trivy-scan:
  stage: scans
  tags:
    - centos
  image: aquasec/trivy:latest
  script:
    - trivy image --format json --output report.json $IMAGE_NAME
  artifacts:
    paths:
      - report.json