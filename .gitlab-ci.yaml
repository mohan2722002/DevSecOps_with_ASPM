stages:
  - sca_scan

sca_scan:
  stage: sca_scan
  tags:
    - centos
  script:
    - echo "üîê Using locally installed Snyk CLI..."
    - snyk auth $SNYK_TOKEN
    - snyk test --json > snyk_sca_report.json || echo "‚ö†Ô∏è Vulnerabilities found."
    - ls -la snyk_sca_report.json || echo "‚ùå Report not generated"
  artifacts:
    paths:
      - snyk_sca_report.json
    when: always
    expire_in: 1 week
  allow_failure: true
